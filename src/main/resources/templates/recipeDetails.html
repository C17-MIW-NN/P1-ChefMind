<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Recipe details</title>


    <link rel="stylesheet" type="text/css" th:href="@{/webjars/bootstrap-icons/font/bootstrap-icons.min.css}">
    <link rel="stylesheet" type="text/css" href="/css/chefmind.css" />
</head>

<body>
<div class="imageBackground">
    <img class="imageInBackground" th:src="${recipe.imageURL}" alt="nothing">
</div>

<nav class="navbar">
    <div class="navbar-items">
        <a class="nav-brand" th:href="@{/category/all}">ChefMind</a>
        <li class="nav-item">
            <a class="nav-link" th:href="@{/category/all}">Recipes</a>
        </li>
    </div>
    <div class="navbar-items">
        <li class="nav-item">
            <form th:action="@{/recipe/search}" method="get">
                <div>
                    <input type="search" name="query" placeholder="Look for recipe"/>
                    <button type="submit" class="search-button">Search</button>
                </div>
            </form>
        </li>
        <li class="nav-item" sec:authorize="isAuthenticated()">
            <a class="nav-link" th:href="@{/user/all}">Users</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" sec:authorize="isAnonymous()" th:href="@{/login}">Login</a>
            <a class="nav-link"
               sec:authorize="isAuthenticated()"
               th:href="@{/logout}">Logout <span sec:authentication="name"></span></a>
        </li>
    </div>
</nav>

<div class="informationContainer">
    <div class="informationTopContainer">
        <div class="recipeTitle">
            <h1 th:text="${recipe.name}"></h1>
            <div class="editRemove" sec:authorize="isAuthenticated()">
                <a class="edit" th:href="@{/recipe/edit/{name}(name = ${recipe.name})}">
                    <i class="bi bi-pencil-fill"></i> Edit</a>
                <a class="remove" th:href="@{/recipe/delete/{recipeId}(recipeId = ${recipe.recipeId})}">
                    <i class="bi bi-trash-fill"></i> Remove</a>
            </div>
        </div>

        <div class="recipeInfoContainer">
            <div class="recipeInfo">
                <p>Author: <span th:text="${recipe.author.username}"></span></p>
            </div>
            <div class="recipeInfo">
                <p>Servings: <span th:text="${recipe.servingSize}"></span></p>
            </div>
            <div class="recipeInfo">
                <p><span th:text="${recipe.calculateTotalKcalPerServing()}"></span> kcal per serving</p>
            </div>
            <div class="recipeInfo">
                <p>Prep: <span th:text="${recipe.prepTime}"></span> mins</p>
            </div>
            <div class="recipeInfo">
                <p>Cook: <span th:text="${recipe.cookingTime}"></span> mins</p>
            </div>
            <div class="recipeInfo">
                <p>Total: <span th:text="${recipe.calculateTotalTime()}"></span> mins</p>
            </div>
            <div class="recipeInfo">
                <p><b>Categories:</b>
                    <a class="categoryLabel" th:each="category : ${recipe.categories}"
                       th:href="@{/category/{name}(name = ${category.categoryName})}"
                       th:text="${category.categoryName}"></a></p>
            </div>
        </div>
    </div>

    <div>
        <div class="recipeIngredientInnerContainer">
            <table>
                <tr>
                    <td>Ingredient</td>
                    <td>Quantity</td>
                    <td>Unit</td>
                </tr>
                <tr th:each="ingredientUse : ${recipe.getIngredientUses()}">
                    <td th:text="${ingredientUse.ingredient.ingredientName}"></td>
                    <td th:text="${ingredientUse.quantityInUnit}"></td>
                    <td th:text="${ingredientUse.unit}"></td>
                </tr>
            </table>

            <div class="recipeIngredientContainer">
                <a>Instructions:</a>
                <ol>
                    <li th:each="instruction: ${recipe.instructions}"
                        th:if="${!#strings.isEmpty(instruction)}"
                        th:text="${instruction}"></li>
                </ol>
            </div>
        </div>
        <div th:replace="~{fragments/general :: footer}"></div>
    </div>
</div>

<div th:replace="~{fragments/general :: bottomScripts}"></div>

</body>
<footer>
</footer>
</html>